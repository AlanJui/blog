---
layout: post
title: 使用 Arrays.binarySearch() 須注意的小細節
date: '2010-05-27T12:24:00.002+08:00'
author: 居正中
tags:
- 知識
modified_time: '2010-06-19T22:47:22.749+08:00'
blogger_id: tag:blogger.com,1999:blog-1068034375721560223.post-5623347885181273669
blogger_orig_url: http://blog.ccc99.tw/2010/05/arraysbinarysearch.html
---

使用 <b style="color: blue;">Arrays.binarySearch() </b>，若發生 "怪怪" 的問題，請先檢查一下，陣列內的元素是否已先做過排序。<br /><br />根據 Java API 的說明文件，使用 "binarySearch" 方法前，須對陣列先行 "排序" 。 (Ref: The array must be sorted prior to making this call......)<br /><br />所以，陣列內各元素的值，若未先排序，就直接做 "搜尋" ，很容易就發生 "意外" 囉！<br /><br /><span style="background-color: yellow;">********************** </span><span style="background-color: yellow;">[ Begin ] **********************</span><br /><span style="background-color: yellow;">binarySearch</span><br /><br /><span style="background-color: yellow;">public static int binarySearch(int[] a,</span><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int key)</span><br /><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp; Searches the specified array of ints for the specified value using the binary search algorithm. </span><b style="background-color: yellow; color: red;">The array must be sorted</b><span style="background-color: yellow;"> (as by the sort(int[]) method)</span><b style="background-color: yellow; color: red;"> prior to making this call. If it is not sorted, the results are undefined.</b><span style="background-color: yellow;"> If the array contains multiple elements with the specified value, there is no guarantee which one will be found.</span><br /><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp; Parameters:</span><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a - the array to be searched</span><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key - the value to be searched for </span><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp; Returns:</span><br /><span style="background-color: yellow;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index of the search key, if it is contained in the array; otherwise, (-(insertion point) - 1). The insertion point is defined as the point at which the key would be inserted into the array: the index of the first element greater than the key, or a.length if all elements in the array are less than the specified key. Note that this guarantees that the return value will be &gt;= 0 if and only if the key is found.</span><br /><br /><span style="background-color: yellow;">**********************</span><span style="background-color: yellow;"> [ End ]</span><span style="background-color: yellow;"> **********************</span><br />以下用程式碼來示範&nbsp; Arrays.binarySearch() "錯誤及正確" 的作法。<br /><br /><span style="color: #274e13;">/********************************************************************</span><br /><span style="color: #274e13;">&nbsp; 示範程式碼</span><br /><span style="color: #274e13;">********************************************************************/</span><br /><span style="color: #274e13;">import java.util.Arrays;</span><br /><br /><span style="color: #274e13;">public class Array_binarySearch_VV {</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;/**</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; * @param args</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; */</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;public static void main(String[] args) {</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;System.out.println("[陣列未先排序，就做搜尋]\n");</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;CanNotWork();</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;System.out.println("===========================\n");</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;System.out.println("[陣列已先排序，再做搜尋]\n");</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;sortBeforeSearch();</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;}</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;/*</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; * 有問題的寫法</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; */</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;static void CanNotWork() {</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i = 0;</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int iSearch = 6;</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int iNumbers[] = { 3, 4, 10, 12, 6, 15 };</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 排序前陣列內各元素的值</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("排序前陣列內各元素的值：");</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Arrays.toString(iNumbers)</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 執行 binarySearch，結果找不到</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("\n搜尋 [" + iSearch + "] 在陣列中的位置？");</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = Arrays.binarySearch(iNumbers,iSearch); </span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("搜尋的結果值：" + i);</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;}</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;/*</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; * 正確的寫法</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp; */</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;static void sortBeforeSearch() {</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i = 0;</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int iSearch = 6;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;int iNumbers[] = { 3, 4, 10, 12, 6, 15 };</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 排序前陣列內各元素的值</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("排序前陣列內各元素的值：");</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Arrays.toString(iNumbers)</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</span><br /><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 執行 sort</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Arrays.sort(iNumbers);</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 排序後陣列內各元素的值</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("排序後陣列內各元素的值：");</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Arrays.toString(iNumbers)</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 執行 binarySearch，結果找得到</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("\n搜尋 [" + iSearch + "] 在陣列中的位置？");</span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = Arrays.binarySearch(iNumbers,iSearch); </span><br /><span style="color: #274e13;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("搜尋的結果值：" + i);</span><br /><span style="color: #274e13;">&nbsp;&nbsp; &nbsp;}</span><br /><span style="color: #274e13;">}</span>